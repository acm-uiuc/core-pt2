{"version":3,"sources":["../../src/middlewares/roleCheck.js"],"names":["requiredRole","req","res","next","currentUser","role","status","send"],"mappings":";;;;;;;eAAe,kBAACA,YAAD,EAAkB;AAC/B,SAAO,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACzB,QAAIF,GAAG,CAACG,WAAJ,CAAgBC,IAAhB,GAAuBL,YAA3B,EAAyC;AACvC,aAAOG,IAAI,EAAX;AACD,KAFD,MAEO;AACL,aAAOD,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,oBAArB,CAAP;AACD;AACF,GAND;AAOD,C","sourcesContent":["export default (requiredRole) => {\n  return (req, res, next) => {\n    if (req.currentUser.role > requiredRole) {\n      return next();\n    } else {\n      return res.status(401).send('Action not allowed');\n    }\n  };\n};\n"],"file":"roleCheck.js"}