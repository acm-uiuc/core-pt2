{"version":3,"file":"auth.js","names":["router","Router","post","req","res","email","body","redirect","authService","generateAndSend","cause","status","send","message","console","log","token","validateToken"],"sources":["../../src/routes/auth.js"],"sourcesContent":["import { Router } from 'express';\nimport authService from '../services/authService'\n\nconst router = Router();\n\nrouter.post('/generate', async (req, res) => {\n  const email = req.body.email;\n  const redirect = req.body.redirect;\n  try {\n    await authService.generateAndSend(redirect, email);\n  } catch (err) {\n    if (err.cause === 'bad_email') {\n      return res.status(403).send(err.message);\n    }\n    console.log(\"error: \" + err);\n    return res.status(500).send(err);\n  }\n  return res.send(\"Sent verification email!\");\n});\n\nrouter.post('/validate', async (req, res) => {\n  const token = req.body.token;\n  let email;\n  try {\n      email = await authService.validateToken(token);\n  } catch(err) {\n    \n    return res.status(401).send(\"Failed to verify valid token\");\n  }\n  return res.send(email);\n});\n\nexport default router;"],"mappings":";;;;;;;AAAA;AACA;AAAiD;AAAA,+CAAjD;AAAA;AAAA;AAEA,IAAMA,MAAM,GAAG,IAAAC,eAAM,GAAE;AAEvBD,MAAM,CAACE,IAAI,CAAC,WAAW;EAAA,sEAAE,iBAAOC,GAAG,EAAEC,GAAG;IAAA;IAAA;MAAA;QAAA;UAAA;YAChCC,KAAK,GAAGF,GAAG,CAACG,IAAI,CAACD,KAAK;YACtBE,QAAQ,GAAGJ,GAAG,CAACG,IAAI,CAACC,QAAQ;YAAA;YAAA;YAAA,OAE1BC,uBAAW,CAACC,eAAe,CAACF,QAAQ,EAAEF,KAAK,CAAC;UAAA;YAAA;YAAA;UAAA;YAAA;YAAA;YAAA,MAE9C,YAAIK,KAAK,KAAK,WAAW;cAAA;cAAA;YAAA;YAAA,iCACpBN,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,YAAIC,OAAO,CAAC;UAAA;YAE1CC,OAAO,CAACC,GAAG,CAAC,SAAS,cAAM,CAAC;YAAC,iCACtBX,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,aAAK;UAAA;YAAA,iCAE3BR,GAAG,CAACQ,IAAI,CAAC,0BAA0B,CAAC;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAC5C;EAAA;IAAA;EAAA;AAAA,IAAC;AAEFZ,MAAM,CAACE,IAAI,CAAC,WAAW;EAAA,uEAAE,kBAAOC,GAAG,EAAEC,GAAG;IAAA;IAAA;MAAA;QAAA;UAAA;YAChCY,KAAK,GAAGb,GAAG,CAACG,IAAI,CAACU,KAAK;YAAA;YAAA;YAAA,OAGVR,uBAAW,CAACS,aAAa,CAACD,KAAK,CAAC;UAAA;YAA9CX,KAAK;YAAA;YAAA;UAAA;YAAA;YAAA;YAAA,kCAGAD,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,8BAA8B,CAAC;UAAA;YAAA,kCAEtDR,GAAG,CAACQ,IAAI,CAACP,KAAK,CAAC;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CACvB;EAAA;IAAA;EAAA;AAAA,IAAC;AAAC,eAEYL,MAAM;AAAA"}